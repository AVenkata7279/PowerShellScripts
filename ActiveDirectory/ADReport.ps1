Start-Transcript "D:\ADuserReport\AccountAttrReports\Logs\ADAtt.log"
import-module ActiveDirectory
$path = "D:\ADuserReport\AccountAttrReports\Reports\ADUserAttr_$(get-date -f dd-MM-yyyy-hh-mm).csv"
$path
$out = Get-ADUser -ResultSetSize $null -Filter * -Property * -Verbose | Select-Object -Property SamAccountName,GivenName,sn,DisplayName,AccountExpirationDate,AccountLockoutTime,AccountNotDelegated,BadLogonCount,badPasswordTime,badPwdCount,CannotChangePassword,CanonicalName,City,CN,Company,Country,countryCode,Created,createTimeStamp,Deleted,Department,Description,DistinguishedName,Division,EmailAddress,EmployeeID,EmployeeNumber,Enabled,Fax,HomeDirectory,HomedirRequired,HomeDrive,homeMDB,homeMTA,HomePhone,Initials,ipPhone,isDeleted,LastBadPasswordAttempt,LastKnownParent,lastLogoff,lastLogon,LastLogonDate,LegacyExchangeDN,LockedOut,logonCount,LogonWorkstations,mail,mailNickname,Manager,mDBUseDefaults,{$_.MemberOf},mobile,MobilePhone,Modified,msExchHomeServerName,msExchMailboxGuid,msExchRBACPolicyLink,msExchVersion,Name,ObjectCategory,ObjectClass,ObjectGUID,objectSid,Office,OfficePhone,Organization,PasswordExpired,PasswordLastSet,PasswordNeverExpires,PasswordNotRequired,POBox,PostalCode,ProfilePath,{$_.proxyAddresses},pwdLastSet,ScriptPath,SID,State,StreetAddress,Surname,telephoneNumber,Title,UserPrincipalName,whenChanged,whenCreated,extensionAttribute1,extensionAttribute2,extensionAttribute3,extensionAttribute4,extensionAttribute5,extensionAttribute6,extensionAttribute7,extensionAttribute8,extensionAttribute9,extensionAttribute10,extensionAttribute11,extensionAttribute12,extensionAttribute13,extensionAttribute14,extensionAttribute15
$out | Export-Csv $path
Stop-Transcript
